<!DOCTYPE html5>

<html>
    <head>
        <title>wikidraw</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/bootstrap.min.css")">
        <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/bootstrap-responsive.min.css")">
        <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/wikidraw.css")">
        <link rel="shortcut icon" type="image/png" href="@routes.Assets.at("images/favicon.png")">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
        <script src="@routes.Assets.at("javascripts/bootstrap.min.js")" type="text/javascript"></script>
        <script src="@routes.Assets.at("javascripts/raphael-min.js")" type="text/javascript"></script>
    </head>
    <body>
    	<div class="row-fluid">
			<div class="span6">
				<h4>edit</h4>
<textarea id="edit">
` 안녕하세요, prepare

* 안녕하세요, activity

( 안녕하세요, input

) 안녕하세요, output
</textarea>
		    </div>
			<div class="span6">
		    	<h4>preview</h4>
				<div id='preview'></div>
		    </div>
		</div>
		<div class="row-fluid">
<h4>todo</h4>
<ul>
<li>draw arrow between shape</li>
</ul>
		</div>
		
		<script language="javascript">
var paper = Raphael('preview');
var unit = 15;
var fontsize = 16;
var shapeY = 40

prepare('안녕하세요, prepare')

activity('안녕하세요, activity')

input('안녕하세요, input')

output('안녕하세요, output')

function prepare(text) {
	var prepareText = paper.text(paper.width / 2, shapeY, text).attr({'font-size':fontsize})
	var prepareTextBBox = prepareText.getBBox()
	var x = prepareTextBBox.x
	var x2 = prepareTextBBox.x2
	var y = prepareTextBBox.y
	var y2 = prepareTextBBox.y2
	var ym = (y + y2) / 2
	shapeY += prepareTextBBox.height + (unit * 4)
	
	var pathString = 'M' + (x - unit) + ',' + (y - unit)
	pathString += 'H' + (x2 + unit)
	pathString += 'L' + (x2 + unit * 2) + ',' + (ym)
	pathString += 'L' + (x2 + unit) + ',' + (y2 + unit)
	pathString += 'H' + (x - unit)
	pathString += 'L' + (x - unit * 2) + ',' + (ym)
	pathString += 'L' + (x - unit) + ',' + (y - unit)

	return paper.path(pathString)
}

function activity(text) {
	var activityText = paper.text(paper.width / 2, shapeY, text).attr({'font-size':fontsize})
	var activityTextBBox = activityText.getBBox()
	var x = activityTextBBox.x
	var x2 = activityTextBBox.x2
	var y = activityTextBBox.y
	var y2 = activityTextBBox.y2
	shapeY += activityTextBBox.height + (unit * 4)
	
	return paper.rect((x-unit), (y-unit), (x2-x+(2*unit)), (y2-y+(2*unit)))
}

function input(text) {
	var activityText = paper.text(paper.width / 2, shapeY, text).attr({'font-size':fontsize})
	var activityTextBBox = activityText.getBBox()
	var x = activityTextBBox.x
	var x2 = activityTextBBox.x2
	var y = activityTextBBox.y
	var y2 = activityTextBBox.y2
	var ym = (y + y2) / 2
	shapeY += activityTextBBox.height + (unit * 4)
	
	var pathString = 'M' + (x - unit) + ',' + (y - unit)
	pathString += 'H' + (x2 + unit)
	pathString += 'L' + (x2 + unit * 2) + ',' + (ym)
	pathString += 'L' + (x2 + unit) + ',' + (y2 + unit)
	pathString += 'H' + (x - unit)
	pathString += 'V' + (x - unit) + ',' + (y - unit)

	return paper.path(pathString)
}

function output(text) {
	var activityText = paper.text(paper.width / 2, shapeY, text).attr({'font-size':fontsize})
	var activityTextBBox = activityText.getBBox()
	var x = activityTextBBox.x
	var x2 = activityTextBBox.x2
	var y = activityTextBBox.y
	var y2 = activityTextBBox.y2
	var ym = (y + y2) / 2
	shapeY += activityTextBBox.height + (unit * 4)
	
	var pathString = 'M' + (x - unit) + ',' + (y - unit)
	pathString += 'H' + (x2 + unit)
	pathString += 'V' + (y2 + unit)
	pathString += 'H' + (x - unit)
	pathString += 'L' + (x - unit * 2) + ',' + (ym)
	pathString += 'L' + (x - unit) + ',' + (y - unit)

	return paper.path(pathString)
}
		</script>
    </body>
</html>
